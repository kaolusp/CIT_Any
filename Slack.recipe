<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">

<plist version="1.0">

<dict>

    <key>Description</key>

    <string>Downloads the latest Slack.</string>

    <key>Identifier</key>

    <string>com.github.autopkg.download.slack</string>

    <key>Input</key>

    <dict>

        <key>NAME</key>

        <string>Slack</string>

        <key>DOWNLOAD_URL</key>

        <string>https://downloads.slack-edge.com/mac_releases/Slack-3.0.0.dmg</string>

    </dict>

    <key>MinimumVersion</key>

    <string>0.2.0</string>

    <key>Process</key>

    <array>

        <dict>

            <key>Processor</key>

            <string>URLDownloader</string>

            <key>Arguments</key>

            <dict>

                <key>url</key>

                <string>%DOWNLOAD_URL%</string>

                <key>filename</key>

                <string>%NAME%.dmg</string>

            </dict>

        </dict>

        <dict>

            <key>Processor</key>

            <string>EndOfCheckPhase</string>

        </dict>

        <dict>   

            <key>Processor</key>   

            <string>CodeSignatureVerifier</string>   

            <key>Arguments</key>   

            <dict>   

                <key>input_path</key>   

                <string>%pathname%/Slack*.app</string>

                <key>expected_authority_names</key>

                <array>

                    <string>Developer ID Installer: Slack Technologies, Inc. (BQR82RBBHL)</string>

                    <string>Developer ID Certification Authority</string>

                    <string>Apple Root CA</string>

                </array>

            </dict>

        </dict>

             <dict>

            <key>Processor</key>

            <string>AppDmgVersioner</string>

            <key>Arguments</key>

            <dict>

                <key>dmg_path</key>

                <string>%pathname%</string>

            </dict>

        </dict>

        <dict>

            <key>Processor</key>

            <string>PkgRootCreator</string>

            <key>Arguments</key>

            <dict>

                <key>pkgroot</key>

                <string>%RECIPE_CACHE_DIR%/%NAME%</string>

                <key>pkgdirs</key>

                <dict>

                    <key>Applications</key>

                    <string>0775</string>

                </dict>

            </dict>

        </dict>

        <dict>

            <key>Processor</key>

            <string>Copier</string>

            <key>Arguments</key>

            <dict>

                <key>source_path</key>

                <string>%pathname%/VLC.app</string>

                <key>destination_path</key>

                <string>%pkgroot%/Applications/Slack.app</string>

            </dict>

        </dict>
       
              <dict>

            <key>Processor</key>

            <string>PkgCreator</string>

            <key>Arguments</key>

            <dict>

                <key>pkgname</key>

                <string>%NAME%-%version%</string>

                <key>pkg_request</key>

                <dict>

                    <key>pkgdir</key>

                    <string>%RECIPE_CACHE_DIR%</string>

                    <key>id</key>

                    <string>com.slack.pkg</string>

                    <key>resources</key>

                    <string>Resources</string>

                    <key>options</key>

                    <string>purge_ds_store</string>

                    <key>chown</key>

                    <array>

                        <dict>

                            <key>path</key>

                            <string>Applications</string>

                            <key>user</key>

                            <string>root</string>

                            <key>group</key>

                            <string>admin</string>

                        </dict>

                    </array>

                </dict>

            </dict>

        </dict>
        
    </array>

</dict>

</plist>
